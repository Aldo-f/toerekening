<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toerekening Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .table-row-animate { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        /* Make table cells smaller to fit */
        .compact-table td, .compact-table th { padding: 0.5rem 0.25rem; font-size: 0.75rem; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-2">Toerekening Calculator</h1>
            <p class="text-gray-600">Berekening volgens art. 5.210 BW (betalingen worden eerst op interest aangerekend)</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            
            <!-- Input Panel -->
            <div class="lg:col-span-4 space-y-6">
                
                <!-- Start Card -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                    <h2 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        Start
                    </h2>
                    
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Initiële schuld (€)</label>
                            <input type="number" id="initialDebt" step="0.01" value="3000" 
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Rentevoet (%)</label>
                            <input type="number" id="initialRate" step="0.01" value="2" 
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Startdatum</label>
                        <input type="text" id="initialDate" placeholder="dd/mm/yyyy" value="22/05/2016" 
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                    </div>
                    
                    <!-- Kapitalisatie Toggle -->
                    <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                        <label class="flex items-start cursor-pointer">
                            <input type="checkbox" id="kapitalisatie" class="mt-1 w-5 h-5 text-blue-600 rounded focus:ring-blue-500">
                            <div class="ml-3">
                                <span class="block text-sm font-semibold text-amber-800">Kapitalisatie (rente-op-rente)</span>
                                <p class="text-xs text-amber-700 mt-1">
                                    ⚠️ Let op: In België is anatocisme verboden (art. 5.207 BW). 
                                    Enkel toegestaan met expliciete contractuele clausule of gerechtelijke aanmaning.
                                </p>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Betalingen Card -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                    <h2 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg>
                        Betalingen
                    </h2>
                    
                    <div id="entries" class="space-y-2 mb-4 max-h-64 overflow-y-auto"></div>
                    
                    <button onclick="addEntry()" 
                        class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium flex items-center justify-center">
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                        Voeg betaling toe
                    </button>
                </div>

                <!-- Acties Card -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                    <div class="flex flex-wrap gap-2">
                        <button onclick="calculate()" 
                            class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium">
                            Bereken
                        </button>
                        <button onclick="resetForm()" 
                            class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition font-medium">
                            Reset
                        </button>
                        <button onclick="copyUrl()" 
                            class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition font-medium">
                            <svg class="w-4 h-4 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                        </button>
                        <button onclick="exportExcel()" 
                            class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-medium">
                            <svg class="w-4 h-4 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                        </button>
                    </div>
                </div>

                <!-- Share URL -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                    <h3 class="text-sm font-semibold text-gray-800 mb-2">Deel deze berekening</h3>
                    <div class="bg-gray-50 p-3 rounded-lg overflow-x-auto">
                        <code id="shareUrl" class="text-xs text-gray-600 break-all"></code>
                    </div>
                </div>
            </div>

            <!-- Result Panel -->
            <div class="lg:col-span-8 space-y-6">
                
                <!-- Chart Card -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                    <h2 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"></path></svg>
                        Grafiek
                    </h2>
                    <div class="relative h-64">
                        <canvas id="resultChart"></canvas>
                    </div>
                </div>

                <!-- Table Card -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                    <h2 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg>
                        Resultaat
                    </h2>
                    
                    <div class="overflow-x-auto">
                        <table id="resultTable" class="w-full compact-table">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="px-2 py-2 text-left text-xs font-semibold text-gray-600 uppercase">Datum</th>
                                    <th class="px-2 py-2 text-right text-xs font-semibold text-gray-600 uppercase">Dagen</th>
                                    <th class="px-2 py-2 text-right text-xs font-semibold text-gray-600 uppercase">Schuld</th>
                                    <th class="px-2 py-2 text-right text-xs font-semibold text-gray-600 uppercase">Afbet.</th>
                                    <th class="px-2 py-2 text-right text-xs font-semibold text-gray-600 uppercase">Rente</th>
                                    <th class="px-2 py-2 text-right text-xs font-semibold text-gray-600 uppercase">Hoofdsom</th>
                                    <th class="px-2 py-2 text-right text-xs font-semibold text-blue-600 uppercase">Interest</th>
                                    <th class="px-2 py-2 text-right text-xs font-semibold text-purple-600 uppercase">Toerek.</th>
                                    <th class="px-2 py-2 text-right text-xs font-semibold text-gray-600 uppercase">Saldo</th>
                                    <th class="px-2 py-2 text-right text-xs font-semibold text-gray-900 uppercase">Totaal</th>
                                </tr>
                            </thead>
                            <tbody id="resultBody" class="divide-y divide-gray-100">
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="emptyState" class="text-center py-12 text-gray-400">
                        <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                        <p>Voeg betalingen toe en klik op "Bereken"</p>
                    </div>
                </div>

                <!-- Bronnen -->
                <div class="mt-6 bg-gray-100 rounded-xl p-6">
                    <h3 class="text-sm font-semibold text-gray-800 mb-3 flex items-center">
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
                        Juridische Bronnen
                    </h3>
                    <ul class="text-sm text-gray-600 space-y-1">
                        <li><strong>Art. 5.207 BW</strong> (oud art. 1154 BW): Anatocisme - 
                            <a href="https://www.elfri.be/anatocisme" target="_blank" class="text-blue-600 hover:underline">elfri.be</a></li>
                        <li><strong>Art. 5.210 BW</strong> (oud art. 1254 BW): Toerekening van betalingen</li>
                        <li><strong>DaproWeb</strong>: 
                            <a href="https://daproweb.be/nl/torekening" target="_blank" class="text-blue-600 hover:underline">daproweb.be</a></li>
                    </ul>
                    <p class="text-xs text-gray-500 mt-3 bg-white p-2 rounded border">
                        <strong>Let op:</strong> In België is kapitalisatie enkel toegestaan met (1) expliciete contractuele clausule OF (2) gerechtelijke aanmaning. Zonder dit is enkelvoudige rente van toepassing.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        function parseDate(str) {
            const parts = str.split('/');
            if (parts.length !== 3) return null;
            return new Date(parts[2], parts[1] - 1, parts[0]);
        }
        
        function formatDate(date) {
            const d = String(date.getDate()).padStart(2, '0');
            const m = String(date.getMonth() + 1).padStart(2, '0');
            const y = date.getFullYear();
            return `${d}/${m}/${y}`;
        }
        
        function calcDays(d1, d2) {
            return Math.round((d2 - d1) / (1000 * 60 * 60 * 24));
        }
        
        function round2(num) {
            return Math.round(num * 100) / 100;
        }
        
        function calcInterest(principal, rate, days) {
            return round2(principal * rate / 100 * days / 365);
        }
        
        function formatEuro(amount) {
            if (amount === 0) return '€ -';
            return '€ ' + amount.toFixed(2).replace('.', ',');
        }
        
        function addEntry(date = '', debt = '', payment = '', rate = '') {
            const div = document.createElement('div');
            div.className = 'grid grid-cols-5 gap-2 items-center';
            div.innerHTML = `
                <input type="text" class="date-input col-span-1 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500" placeholder="dd/mm/yyyy" value="${date}">
                <input type="number" class="debt-input col-span-1 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500" placeholder="Schuld" value="${debt}">
                <input type="number" class="payment-input col-span-1 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500" placeholder="Betaling" value="${payment}">
                <input type="number" class="rate-input col-span-1 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500" placeholder="%" value="${rate}">
                <button onclick="this.parentElement.remove(); updateShareUrl();" class="px-2 py-1 bg-red-100 text-red-600 rounded hover:bg-red-200 transition text-sm">×</button>
            `;
            document.getElementById('entries').appendChild(div);
        }
        
        function getEntries() {
            const rows = document.querySelectorAll('#entries .grid');
            const result = [];
            rows.forEach(row => {
                const date = row.querySelector('.date-input').value;
                const debt = parseFloat(row.querySelector('.debt-input').value) || 0;
                const payment = parseFloat(row.querySelector('.payment-input').value) || 0;
                const rate = parseFloat(row.querySelector('.rate-input').value) || 0;
                if (date) result.push({ date, debt, payment, rate });
            });
            return result;
        }
        
        function calculate() {
            const initialDebt = parseFloat(document.getElementById('initialDebt').value) || 0;
            const initialRate = parseFloat(document.getElementById('initialRate').value) || 0;
            const initialDateStr = document.getElementById('initialDate').value;
            const initialDate = parseDate(initialDateStr);
            
            if (!initialDate) {
                alert('Ongeldige startdatum');
                return;
            }
            
            const entriesData = getEntries();
            
            let allDates = [{ date: initialDate, debt: 0, payment: 0, rate: initialRate, days: 0 }];
            let prevDate = initialDate;
            
            entriesData.forEach(e => {
                const d = parseDate(e.date);
                if (d) {
                    const days = calcDays(prevDate, d);
                    allDates.push({ date: d, debt: e.debt, payment: e.payment, rate: e.rate, days });
                    prevDate = d;
                }
            });
            
            // Chart initialization
            let chartInstance = null;
            
            function updateChart(labels, principalData, toerekeningData, totaalData) {
                const ctx = document.getElementById('resultChart').getContext('2d');
                
                if (chartInstance) {
                    chartInstance.destroy();
                }
                
                chartInstance = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: 'Hoofdsom',
                                data: principalData,
                                borderColor: '#374151',
                                backgroundColor: 'rgba(55, 65, 81, 0.1)',
                                fill: true,
                                tension: 0.3
                            },
                            {
                                label: 'Toerekening',
                                data: toerekeningData,
                                borderColor: '#9333ea',
                                backgroundColor: 'rgba(147, 51, 234, 0.1)',
                                fill: true,
                                tension: 0.3
                            },
                            {
                                label: 'Totaal',
                                data: totaalData,
                                borderColor: '#2563eb',
                                backgroundColor: 'rgba(37, 99, 235, 0.1)',
                                fill: false,
                                tension: 0.3,
                                borderWidth: 2
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            mode: 'index',
                            intersect: false,
                        },
                        plugins: {
                            legend: {
                                position: 'bottom',
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return context.dataset.label + ': €' + context.parsed.y.toFixed(2);
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return '€' + value;
                                    }
                                }
                            }
                        }
                    }
                });
            }
            
            const kapitalisatie = document.getElementById('kapitalisatie').checked;
            let principal = initialDebt;
            let toerekening = 0;
            const results = [];
            
            for (let i = 0; i < allDates.length; i++) {
                const entry = allDates[i];
                const interest = calcInterest(principal, entry.rate, entry.days);
                
                if (kapitalisatie && entry.rate >= 10) {
                    principal = round2(principal + interest);
                }
                
                toerekening = round2(toerekening + interest);
                
                if (entry.payment < 0) {
                    const paymentAbs = Math.abs(entry.payment);
                    toerekening = round2(toerekening - paymentAbs);
                    if (toerekening < 0) {
                        principal = round2(principal + toerekening);
                        toerekening = 0;
                    }
                }
                
                if (entry.debt > 0) {
                    principal = round2(principal + entry.debt);
                }
                
                const saldo = round2(principal + toerekening);
                const totaal = round2(saldo + interest);
                
                results.push({
                    date: formatDate(entry.date),
                    days: entry.days,
                    debt: entry.debt,
                    payment: entry.payment,
                    rate: entry.rate,
                    principal: principal,
                    interest: interest,
                    toerekening: toerekening,
                    saldo: saldo,
                    totaal: totaal
                });
            }
            
            const tbody = document.getElementById('resultBody');
            const emptyState = document.getElementById('emptyState');
            
            if (results.length === 0) {
                tbody.innerHTML = '';
                emptyState.classList.remove('hidden');
                updateChart([], [], [], []);
            } else {
                emptyState.classList.add('hidden');
                tbody.innerHTML = results.map(r => `
                    <tr class="hover:bg-gray-50 transition table-row-animate">
                        <td class="px-2 py-2 text-xs text-gray-900">${r.date}</td>
                        <td class="px-2 py-2 text-xs text-gray-600 text-right">${r.days}</td>
                        <td class="px-2 py-2 text-xs text-gray-600 text-right">${r.debt > 0 ? formatEuro(r.debt) : '-'}</td>
                        <td class="px-2 py-2 text-xs text-red-600 text-right">${r.payment < 0 ? formatEuro(r.payment) : '-'}</td>
                        <td class="px-2 py-2 text-xs text-gray-600 text-right">${r.rate}%</td>
                        <td class="px-2 py-2 text-xs text-gray-900 text-right font-medium">€${r.principal.toFixed(2)}</td>
                        <td class="px-2 py-2 text-xs text-blue-600 text-right">€${r.interest.toFixed(2)}</td>
                        <td class="px-2 py-2 text-xs text-purple-600 text-right">€${r.toerekening.toFixed(2)}</td>
                        <td class="px-2 py-2 text-xs text-gray-700 text-right font-medium">€${r.saldo.toFixed(2)}</td>
                        <td class="px-2 py-2 text-xs text-gray-900 text-right font-bold">€${r.totaal.toFixed(2)}</td>
                    </tr>
                `).join('');
                
                // Update chart
                const labels = results.map(r => r.date);
                const principalData = results.map(r => r.principal);
                const toerekeningData = results.map(r => r.toerekening);
                const totaalData = results.map(r => r.totaal);
                updateChart(labels, principalData, toerekeningData, totaalData);
            }
            
            updateShareUrl();
        }
        
        function updateShareUrl() {
            const initialDebt = document.getElementById('initialDebt').value;
            const initialRate = document.getElementById('initialRate').value;
            const initialDate = document.getElementById('initialDate').value;
            const kapitalisatie = document.getElementById('kapitalisatie').checked;
            const entriesData = getEntries();
            
            const params = new URLSearchParams();
            params.set('d', initialDebt);
            params.set('r', initialRate);
            params.set('s', initialDate);
            if (kapitalisatie) params.set('k', '1');
            
            if (entriesData.length > 0) {
                const entriesStr = entriesData.map(e => `${e.date},${e.debt},${e.payment},${e.rate}`).join('|');
                params.set('e', entriesStr);
            }
            
            const url = `${window.location.origin}${window.location.pathname}?${params.toString()}`;
            document.getElementById('shareUrl').textContent = url;
        }
        
        function loadFromUrl() {
            const params = new URLSearchParams(window.location.search);
            
            if (params.has('d')) document.getElementById('initialDebt').value = params.get('d');
            if (params.has('r')) document.getElementById('initialRate').value = params.get('r');
            if (params.has('s')) document.getElementById('initialDate').value = params.get('s');
            if (params.has('k')) document.getElementById('kapitalisatie').checked = params.get('k') === '1';
            
            if (params.has('e')) {
                document.getElementById('entries').innerHTML = '';
                const entriesStr = params.get('e').split('|');
                entriesStr.forEach(entry => {
                    const [date, debt, payment, rate] = entry.split(',');
                    addEntry(date, debt, payment, rate);
                });
            }
            
            if (params.has('d') || params.has('e')) {
                calculate();
            }
        }
        
        function copyUrl() {
            const url = document.getElementById('shareUrl').textContent;
            navigator.clipboard.writeText(url).then(() => {
                alert('URL gekopieerd naar klembord!');
            });
        }
        
        function exportExcel() {
            const rows = document.querySelectorAll('#resultBody tr');
            if (rows.length === 0) {
                alert('Voer eerst een berekening uit');
                return;
            }
            
            let csv = 'Datum;Dagen;Schuld;Afbetaling;Rentevoet;Hoofdsom;Interest;Toerekening;Saldo;Totaal\n';
            
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                let rowData = [];
                cells.forEach(cell => {
                    let text = cell.textContent.replace('€', '').trim();
                    if (text === '-') text = '';
                    rowData.push(text);
                });
                csv += rowData.join(';') + '\n';
            });
            
            const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'toerekening.csv';
            link.click();
        }
        
        function resetForm() {
            document.getElementById('initialDebt').value = '3000';
            document.getElementById('initialRate').value = '2';
            document.getElementById('initialDate').value = '22/05/2016';
            document.getElementById('kapitalisatie').checked = false;
            document.getElementById('entries').innerHTML = '';
            document.getElementById('resultBody').innerHTML = '';
            document.getElementById('emptyState').classList.remove('hidden');
            history.replaceState({}, '', window.location.pathname);
            updateShareUrl();
        }
        
        function loadDefaultExample() {
            document.getElementById('initialDebt').value = '3000';
            document.getElementById('initialRate').value = '2';
            document.getElementById('initialDate').value = '22/05/2016';
            document.getElementById('entries').innerHTML = '';
            
            const exampleEntries = [
                ['22/05/2018', '0', '0', '2'],
                ['12/03/2021', '0', '-100', '10'],
                ['18/03/2021', '0', '-100', '10'],
                ['29/04/2021', '0', '-300', '10'],
                ['04/08/2021', '0', '-100', '10'],
                ['26/01/2022', '0', '-2.04', '10'],
                ['04/04/2022', '0', '-100', '10'],
                ['13/04/2022', '0', '-100', '10'],
                ['02/04/2024', '0', '-500', '10'],
                ['10/09/2024', '0', '-850', '10'],
                ['29/11/2024', '0', '-250', '10'],
                ['02/12/2024', '0', '-1010', '10'],
                ['17/12/2025', '0', '-800', '10'],
                ['24/02/2026', '0', '0', '10'],
            ];
            
            exampleEntries.forEach(e => addEntry(e[0], e[1], e[2], e[3]));
            calculate();
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            if (params.has('d') || params.has('e')) {
                loadFromUrl();
            } else {
                loadDefaultExample();
            }
            
            document.getElementById('kapitalisatie').addEventListener('change', calculate);
        });
    </script>
</body>
</html>
